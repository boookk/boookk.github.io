---
title: "WebFlux"
date: 2022-04-15 23:00:00 +0900
categories: [MSA]
tags: [msa, webflux, spring]
---

## â“ WebFlux
> Clientì™€ Serverì—ì„œ reactive ìŠ¤íƒ€ì¼ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ë„ì™€ì£¼ëŠ” ëª¨ë“ˆ
{: .prompt-tip }

- Spring5ì—ì„œ reactive stackì„ ì§€ì›í•˜ëŠ” web container framework

<br>

## ğŸ” WebFlux íŠ¹ì§•

### <mark style='background-color: #f1f8ff'> Non-Blocking IO </mark>
- ìµœì†Œí•œì˜ ë¦¬ì†ŒìŠ¤ë¡œ íš¨ìœ¨ì ì¸ ìš´ì˜
- Singler worker threadê°€ event loop ì²˜ë¦¬

> Event loopëŠ” ì½”ì–´ ê°œìˆ˜ë§Œí¼ ì¡´ì¬
{: .prompt-warning }

### <mark style='background-color: #f1f8ff'> Functional Endpoints </mark>
- Lambda ê¸°ë°˜ functional programming model
- Request routerê°€ handlerë¡œ request routing
- Handler methodì— @RequestMapping ì„ ì–¸ë¶€ ì—†ì´ request, responseë¥¼ appì—ì„œ ì „ë¶€ ì œì–´

<br>

## ğŸ“Š Spring MVC and WebFlux Comparison
![image](https://docs.spring.io/spring-framework/docs/current/reference/html/images/spring-mvc-and-webflux-venn.png){: w="400"}
_https://docs.spring.io_

### <mark style='background-color: #f1f8ff'> MVC </mark>
- ìš”ì²­ ë‹¹ ìŠ¤ë ˆë“œë¥¼ ë”°ë¡œ í• ë‹¹ë°›ì•„ `blocking` ì²˜ë¦¬
- ìš”ì²­ì´ ë§ì„ ìˆ˜ë¡ ìŠ¤ë ˆë“œ ê°„ `context switching` ë¹„ìš© ì¦ê°€
- ì„œë²„ì˜ í•˜ë“œì›¨ì–´ ì„±ëŠ¥ì— ë”°ë¼ ì›í™œí•œ ì„œë²„ ìš´ì˜ ê°€ëŠ¥

### <mark style='background-color: #f1f8ff'> WebFlux </mark>
- Event loop modelë¡œ ìš”ì²­ì„ `Non blocking` ì²˜ë¦¬
- ì ì€ ìŠ¤ë ˆë“œì—ì„œ ì—¬ëŸ¬ ì‘ì—… ì²˜ë¦¬
- ìŠ¤ë ˆë“œ ê°„ `context switching` ë¹„ìš© ê°ì†Œ
- ìš”ì²­ì´ ì ì„ ë•Œ êµ³ì´ WebFluxë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ğŸ™„..

<br>

## ğŸ“‹ WebFlux í”„ë¡œì íŠ¸ êµ¬ì„±

- Filter
- Handler
- WebClient
- WebFluxConfigurer

<br>

## ğŸˆ Handler

### <mark style='background-color: #f1f8ff'> HttpHandler </mark>
- `Annotated Controller` (ê¸°ì¡´ì˜ MVCì™€ ë™ì¼í•œ í˜•ì‹)
	- Annotationsë¥¼ í†µí•´ ì„ ì–¸í•˜ë©° ì½œë°± ë°›ëŠ”ë‹¤.

### <mark style='background-color: #f1f8ff'> WebHandler </mark>
- `Functional Endpoint`
	- ì²˜ìŒë¶€í„° ëê¹Œì§€ ìš”ì²­ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹ ë° ì œì–´
- `DispatcherHandler`ê°€ ê° ì»´í¬ë„ŒíŠ¸ í˜¸ì¶œ

<br>

## ğŸ  Router

### <mark style='background-color: #f1f8ff'> Routing Function </mark>
- Handler Functionì— ìš”ì²­ë“¤ì„ routing í•´ì£¼ëŠ” ì—­í• 
- @RequestMapping ì—­í• ê³¼ ìœ ì‚¬
	- @RequestMappingì€ dataë§Œ ì „ë‹¬
	- Router Functionì€ `Mono<Handler Function>`ë¡œ í•¨ìˆ˜ ì „ë‹¬

<br>

## ğŸ”Š Filter

- WebHandler APIì— ì ìš©
- ìš”ì²­ ì²˜ë¦¬ ì „ì— **ì„ í–‰ ë¡œì§ ì‹¤í–‰ ê°€ëŠ¥**
- `API Gatway` ì—­í• ì„ í•˜ëŠ” appì—ì„œ ìì£¼ ì‚¬ìš©

<br>

## ğŸ“± WebClient

> Non-blocking Http Client Module
{: .prompt-tip }

- HTTP Requestë¥¼ ìˆ˜í–‰í•˜ëŠ” client

<br>

## ğŸ“ R2DBC

- JDBCì˜ Blocking APIë¥¼ ëŒ€ì²´í•˜ëŠ” `Nonblocking API Stack`
- Spring 5.3.2+

> JDBCë¥¼ ì‚¬ìš©í•œë‹¤ë©´, blocking codeê°€ ê²©ë¦¬ë˜ë„ë¡ í•˜ëŠ” ê²ƒì´ ì¤‘ìš”
{: .prompt-tip }

<br>

## ğŸ“ Handling Errors

### <mark style='background-color: #f1f8ff'> WebExceptionHandler </mark>
- WebFilter / WebHandler chainì—ì„œ ë°œìƒí•œ Exception ì²˜ë¦¬

<br>
